<div *ngIf="shop">

  <div class="margin-bottom">
    <button class="back-button"
            mat-button
            color="primary"
            [routerLink]="'/shops'"
            [queryParams]="{'location' : getCachedZipCode()}"
    >
      Zurück zur Übersicht
    </button>
  </div>

  <mat-card class="mat-elevation-z5">
    <mat-card-header>
      <mat-card-title class="margin-vertical" id="title">{{ shop.name }}</mat-card-title>
      <mat-card-subtitle>
        <div *ngIf="!hasDescription">Dieser Laden hat noch keine Beschreibung hinterlegt.</div>
        <div *ngIf="hasDescription">{{ shop.details }}</div>
      </mat-card-subtitle>
    </mat-card-header>

    <mat-card-content class="mat-card-content">

      <h3 *ngIf="!hasSlots" class="text-no-values">
        Dieser Laden bietet heute leider keine Termine an.
      </h3>

      <div *ngIf="hasSlots">
        <mat-table [dataSource]="slots">
          <ng-container matColumnDef="from">
            <mat-header-cell *matHeaderCellDef> Start</mat-header-cell>
            <mat-cell *matCellDef="let element">{{element.start}}</mat-cell>
          </ng-container>

          <ng-container matColumnDef="to">
            <mat-header-cell *matHeaderCellDef> Ende</mat-header-cell>
            <mat-cell *matCellDef="let element">{{element.end}}</mat-cell>
          </ng-container>

          <ng-container matColumnDef="available">
            <mat-header-cell *matHeaderCellDef> Verfügbar</mat-header-cell>
            <mat-cell *matCellDef="let element">
              <button class="book-button"
                      mat-raised-button
                      *ngIf="element.available"
                      (click)="showBookingPopup(element.id)"
                      color="primary">
                <span class="only-large">Jetzt buchen</span>
                <span class="only-small">Buchen</span>
              </button>

              <button class="book-button" mat-stroked-button *ngIf="!element.available" disabled>
                Belegt
              </button>
            </mat-cell>
          </ng-container>

          <mat-header-row *matHeaderRowDef="['from', 'to', 'available']"></mat-header-row>
          <mat-row *matRowDef="let row; columns: ['from', 'to', 'available']"></mat-row>
        </mat-table>
      </div>

      <div class="shop-details">
        <div id="contact" class="description-text">
          <div>{{shop.name}}</div>
          <div>{{shop.street}} {{shop.addressSupplement}}</div>
          <div>{{shop.zipCode}}</div>
          <div>{{shop.city}}</div>
          <div><a href="{{returnValidLink(shop.website)}}">{{shop.website}}</a></div>
          <div><a href="mailto:{{shop.email}}">{{shop.email}}</a></div>
        </div>
        <div class="contact-types">
          <contact-types [availableContactTypes]="shop.contactTypes"></contact-types>
        </div>
      </div>

    </mat-card-content>
  </mat-card>

</div>
