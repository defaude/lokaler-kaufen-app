<div *ngIf="shop">

  <div class="margin-bottom">
    <button class="back-button"
            mat-button
            color="primary" (click)="back()">
      Zurück
    </button>
  </div>

  <!--  ONLY LARGE LAYOUT-->
  <div class="only-large">
    <div *ngIf="shop.imageUrl" class="shop-details-card-image-container mat-elevation-z3">
      <img src="{{shop.imageUrl}}" alt="Shop Logo" class="shop-logo shop-details-card-image">
    </div>
    <mat-card class="mat-elevation-z3">
      <mat-card-header>
        <div class="shop-header">
          <div class="shop-details-header">
            <mat-card-title class="margin-vertical" id="title">{{ shop.name }}</mat-card-title>
          </div>
        </div>
      </mat-card-header>
      <mat-card-content>
        <div *ngIf="!hasDescription">Dieser Laden hat noch keine Beschreibung hinterlegt.</div>
        <div *ngIf="hasDescription" style="padding-top: 25px">{{ shop.details }}</div>
        <div class="social-links-block">
          <div *ngIf="shop.website" class="social-links">
            <a href="{{returnValidLink(shop.website)}}" target="_blank" class="social-links"
               style="padding-left: 5px;">
              <img src="../assets/web.png" class="social-links-logo">
              Website</a>
          </div>
          <div *ngIf="shop.socialLinks.facebook" class="social-links">
            <a href="{{returnValidFacebookLink(shop.socialLinks.facebook)}}" target="_blank" class="social-links"
               style="padding-left: 5px;">
              <img src="../assets/facebook.png" class="social-links-logo">
              Facebook</a>
          </div>
          <div *ngIf="shop.socialLinks.instagram" class="social-links">
            <a href="{{returnValidInstagramLink(shop.socialLinks.instagram)}}" target="_blank" class="social-links"
               style="padding-left: 5px;">
              <img src="../assets/instagram.png" class="social-links-logo">
              Instagram</a>
          </div>
          <div *ngIf="shop.socialLinks.twitter" class="social-links">
            <a href="{{returnValidTwitterLink(shop.socialLinks.twitter)}}" target="_blank" class="social-links"
               style="padding-left: 5px;">
              <img src="../assets/twitter.png" class="social-links-logo">
              Twitter</a>
          </div>
        </div>
        <mat-divider></mat-divider>
        <div class="booking-title">
          <h3>Terminbuchung</h3>
          <p>Wählen Sie jetzt Ihren Wunschzeitpunkt aus und {{ shop.name }} ruft Sie für Ihr persönliches
            Beratungsgespräch
            an<span *ngIf="!hasOnlyPhone"> - per Videochat direkt aus dem Laden</span>. <span
              *ngIf="hasOnlyPhone">{{ shop.name }}
              bietet derzeit noch keine Videoberatung an, Sie können sich aber per Telefon beraten lassen.</span></p>
        </div>
        <mat-tab-group>
          <mat-tab *ngFor="let slots of slotsPerDay">
            <ng-template mat-tab-label>
              <div (click)="activatedSlot = slots"
                   [ngClass]="!slots.hasSlots? 'not-open' : ''">{{slots.dayName}}</div>
            </ng-template>
            <ng-template matTabContent>
              <h3 *ngIf="!slots.hasSlots" class="text-no-values margin-top">
                Dieser Laden bietet am {{slots.dayName}} leider keine Termine an.
              </h3>
              <div *ngIf="slots.hasSlots">
                <mat-table [dataSource]="slots.slots" class="margin-top" id="calendar">
                  <ng-container matColumnDef="from">
                    <mat-header-cell *matHeaderCellDef> Start</mat-header-cell>
                    <mat-cell *matCellDef="let element">{{element.start}}</mat-cell>
                  </ng-container>

                  <ng-container matColumnDef="to">
                    <mat-header-cell *matHeaderCellDef> Ende</mat-header-cell>
                    <mat-cell *matCellDef="let element">{{element.end}}</mat-cell>
                  </ng-container>

                  <ng-container matColumnDef="available">
                    <mat-header-cell *matHeaderCellDef> Verfügbar</mat-header-cell>
                    <mat-cell *matCellDef="let element">
                      <button class="book-button"
                              mat-raised-button
                              *ngIf="element.available"
                              (click)="showBookingPopup(element.id)"
                              color="primary">
                        Jetzt buchen
                      </button>

                      <button class="book-button" mat-stroked-button *ngIf="!element.available" disabled>
                        Belegt
                      </button>
                    </mat-cell>
                  </ng-container>

                  <mat-header-row *matHeaderRowDef="['from', 'to', 'available']"></mat-header-row>
                  <mat-row *matRowDef="let row; columns: ['from', 'to', 'available']"></mat-row>
                </mat-table>
              </div>


            </ng-template>
          </mat-tab>
        </mat-tab-group>
        <div class="shop-details margin-big-vertical">
          <div>
            <div class="address-title">Adresse</div>
            <div>{{shop.name}}</div>
            <div>{{shop.street}} {{shop.addressSupplement}}</div>
            <div>{{shop.zipCode}} {{shop.city}}</div>
            <div><a href="mailto:{{shop.email}}">{{shop.email}}</a></div>
          </div>

          <div>
            <contact-types [availableContactTypes]="shop.contactTypes"></contact-types>
          </div>
        </div>
      </mat-card-content>
    </mat-card>
    <page-footer></page-footer>
  </div>
  <!--  END LARGE LAYOUT-->

  <!--  ONLY SMALL LAYOUT-->
  <div class="only-small">
    <div *ngIf="shop.imageUrl">
      <img src="{{shop.imageUrl}}" alt="Shop Logo" class="shop-logo-small shop-details-card-image-small">
    </div>
    <div class="shop-header">
      <div class="shop-details-header">
        <mat-card-title class="margin-vertical" id="title-small">{{ shop.name }}</mat-card-title>
      </div>
    </div>
    <mat-card-content>
      <div *ngIf="!hasDescription">Dieser Laden hat noch keine Beschreibung hinterlegt.</div>
      <div *ngIf="hasDescription" style="padding-top: 25px">{{ shop.details }}</div>
      <div class="social-links-block-small">
        <div *ngIf="shop.website" class="social-links">
          <a href="{{returnValidLink(shop.website)}}" target="_blank" class="social-links"
             style="padding-left: 5px;">
            <img src="../assets/web.png" class="social-links-logo">
            Website</a>
        </div>
        <div *ngIf="shop.socialLinks.facebook" class="social-links">
          <a href="{{returnValidFacebookLink(shop.socialLinks.facebook)}}" target="_blank" class="social-links"
             style="padding-left: 5px;">
            <img src="../assets/facebook.png" class="social-links-logo">
            Facebook</a>
        </div>
        <div *ngIf="shop.socialLinks.instagram" class="social-links">
          <a href="{{returnValidInstagramLink(shop.socialLinks.instagram)}}" target="_blank" class="social-links"
             style="padding-left: 5px;">
            <img src="../assets/instagram.png" class="social-links-logo">
            Instagram</a>
        </div>
        <div *ngIf="shop.socialLinks.twitter" class="social-links">
          <a href="{{returnValidTwitterLink(shop.socialLinks.twitter)}}" target="_blank" class="social-links"
             style="padding-left: 5px;">
            <img src="../assets/twitter.png" class="social-links-logo">
            Twitter</a>
        </div>
      </div>
      <mat-divider></mat-divider>
      <div class="booking-title">
        <h3>Terminbuchung</h3>
        <p>Wählen Sie jetzt Ihren Wunschzeitpunkt aus und {{ shop.name }} ruft Sie für Ihr persönliches
          Beratungsgespräch
          an<span *ngIf="!hasOnlyPhone"> - per Videochat direkt aus dem Laden</span>. <span
            *ngIf="hasOnlyPhone">{{ shop.name }}
            bietet derzeit noch keine Videoberatung an, Sie können sich aber per Telefon beraten lassen.</span></p>
      </div>
      <mat-accordion>
        <mat-expansion-panel *ngFor="let slots of slotsPerDay" [expanded]="slots == activatedSlot"
                             (opened)="activatedSlot = slots">
          <mat-expansion-panel-header>
            <mat-panel-title>
              <div [ngClass]="!slots.hasSlots? 'not-open' : ''">{{slots.dayName}}</div>
            </mat-panel-title>
          </mat-expansion-panel-header>
          <h3 *ngIf="!slots.hasSlots" class="text-no-values">
            Dieser Laden bietet am {{slots.dayName}} leider keine Termine an.
          </h3>
          <div *ngIf="slots.hasSlots">
            <div *ngFor="let slot of slots.slots; last as last">
              <div class="small-booking-row padding-vertical">
                <div>{{ slot.start }} - {{ slot.end }}</div>
                <div>
                  <button *ngIf="slot.available"
                          class="book-button"
                          mat-raised-button
                          color="primary"
                          (click)="showBookingPopup(slot.id)">
                    Buchen
                  </button>

                  <button *ngIf="!slot.available" class="book-button" mat-stroked-button disabled>
                    Belegt
                  </button>
                </div>
              </div>
            </div>
          </div>
        </mat-expansion-panel>
      </mat-accordion>
      <div class="shop-details margin-big-vertical">
        <div>
          <contact-types [availableContactTypes]="shop.contactTypes"></contact-types>
        </div>
      </div>
      <div>
        <div class="address-title">Adresse</div>
        <div>{{shop.name}}</div>
        <div>{{shop.street}} {{shop.addressSupplement}}</div>
        <div>{{shop.zipCode}} {{shop.city}}</div>
        <div><a href="mailto:{{shop.email}}">{{shop.email}}</a></div>
      </div>
    </mat-card-content>
    <page-footer></page-footer>
  </div>
  <!--  END SMALL LAYOUT-->
</div>
